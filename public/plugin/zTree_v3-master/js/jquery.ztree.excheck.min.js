(function(f){var A={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},n={check:{enable:false,autoCheckTrigger:false,chkStyle:A.checkbox.STYLE,nocheckInherit:false,chkDisabledInherit:false,radioType:A.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}},w=function(B){var C=z.getRoot(B);C.radioCheckedList=[]},d=function(B){},o=function(B){var C=B.treeObj,D=r.event;C.bind(D.CHECK,function(G,F,H,E){G.srcEvent=F;u.apply(B.callback.onCheck,[G,H,E])})},y=function(B){var C=B.treeObj,D=r.event;C.unbind(D.CHECK)},p=function(H){var I=H.target,K=z.getSetting(H.data.treeId),F="",C=null,D="",G="",B=null,E=null;if(u.eqs(H.type,"mouseover")){if(K.check.enable&&u.eqs(I.tagName,"span")&&I.getAttribute("treeNode"+r.id.CHECK)!==null){F=u.getNodeMainDom(I).id;D="mouseoverCheck"}}else{if(u.eqs(H.type,"mouseout")){if(K.check.enable&&u.eqs(I.tagName,"span")&&I.getAttribute("treeNode"+r.id.CHECK)!==null){F=u.getNodeMainDom(I).id;D="mouseoutCheck"}}else{if(u.eqs(H.type,"click")){if(K.check.enable&&u.eqs(I.tagName,"span")&&I.getAttribute("treeNode"+r.id.CHECK)!==null){F=u.getNodeMainDom(I).id;D="checkNode"}}}}if(F.length>0){C=z.getNodeCache(K,F);switch(D){case"checkNode":B=m.onCheckNode;break;case"mouseoverCheck":B=m.onMouseoverCheck;break;case"mouseoutCheck":B=m.onMouseoutCheck;break}}var J={stop:D==="checkNode",node:C,nodeEventType:D,nodeEventCallback:B,treeEventType:G,treeEventCallback:E};return J},v=function(J,C,E,F,H,G,D){if(!E){return}var I=z.nodeChecked(J,E);I=z.nodeChecked(J,E,I);E.checkedOld=I;if(typeof E.nocheck=="string"){E.nocheck=u.eqs(E.nocheck,"true")}E.nocheck=!!E.nocheck||(J.check.nocheckInherit&&F&&!!F.nocheck);if(typeof E.chkDisabled=="string"){E.chkDisabled=u.eqs(E.chkDisabled,"true")}E.chkDisabled=!!E.chkDisabled||(J.check.chkDisabledInherit&&F&&!!F.chkDisabled);if(typeof E.halfCheck=="string"){E.halfCheck=u.eqs(E.halfCheck,"true")}E.halfCheck=!!E.halfCheck;E.check_Child_State=-1;E.check_Focus=false;E.getCheckStatus=function(){return z.getCheckStatus(J,E)};if(J.check.chkStyle==r.radio.STYLE&&J.check.radioType==r.radio.TYPE_ALL&&I){var B=z.getRoot(J);B.radioCheckedList.push(E)}},a=function(C,D,B){if(C.check.enable){z.makeChkFlag(C,D);B.push("<span ID='",D.tId,r.id.CHECK,"' class='",k.makeChkClass(C,D),"' treeNode",r.id.CHECK,(D.nocheck===true?" style='display:none;'":""),"></span>")}},l=function(D,C){C.checkNode=function(I,H,J,G){var E=z.nodeChecked(D,I);if(I.chkDisabled===true){return}if(H!==true&&H!==false){H=!E}G=!!G;if(E===H&&!J){return}else{if(G&&u.apply(this.setting.callback.beforeCheck,[this.setting.treeId,I],true)==false){return}}if(u.uCanDo(this.setting)&&this.setting.check.enable&&I.nocheck!==true){z.nodeChecked(D,I,H);var F=j(I,r.id.CHECK,this.setting);if(J||this.setting.check.chkStyle===r.radio.STYLE){k.checkNodeRelation(this.setting,I)}k.setChkClass(this.setting,F,I);k.repairParentChkClassWithSelf(this.setting,I);if(G){this.setting.treeObj.trigger(r.event.CHECK,[null,this.setting.treeId,I])}}};C.checkAllNodes=function(E){k.repairAllChk(this.setting,!!E)};C.getCheckedNodes=function(F){var F=(F!==false);var E=z.nodeChildren(D,z.getRoot(this.setting));return z.getTreeCheckedNodes(this.setting,E,F)};C.getChangeCheckedNodes=function(){var E=z.nodeChildren(D,z.getRoot(this.setting));return z.getTreeChangeCheckedNodes(this.setting,E)};C.setChkDisabled=function(F,E,G,H){E=!!E;G=!!G;H=!!H;k.repairSonChkDisabled(this.setting,F,E,H);k.repairParentChkDisabled(this.setting,F.getParentNode(),E,G)};var B=C.updateNode;C.updateNode=function(G,H){if(B){B.apply(C,arguments)}if(!G||!this.setting.check.enable){return}var E=j(G,this.setting);if(E.get(0)&&u.uCanDo(this.setting)){var F=j(G,r.id.CHECK,this.setting);if(H==true||this.setting.check.chkStyle===r.radio.STYLE){k.checkNodeRelation(this.setting,G)}k.setChkClass(this.setting,F,G);k.repairParentChkClassWithSelf(this.setting,G)}}},q={getRadioCheckedList:function(E){var D=z.getRoot(E).radioCheckedList;for(var C=0,B=D.length;C<B;C++){if(!z.getNodeCache(E,D[C].tId)){D.splice(C,1);C--;B--}}return D},getCheckStatus:function(B,E){if(!B.check.enable||E.nocheck||E.chkDisabled){return null}var D=z.nodeChecked(B,E),C={checked:D,half:E.halfCheck?E.halfCheck:(B.check.chkStyle==r.radio.STYLE?(E.check_Child_State===2):(D?(E.check_Child_State>-1&&E.check_Child_State<2):(E.check_Child_State>0)))};return C},getTreeCheckedNodes:function(K,B,J,G){if(!B){return[]}var I=(J&&K.check.chkStyle==r.radio.STYLE&&K.check.radioType==r.radio.TYPE_ALL);G=!G?[]:G;for(var H=0,F=B.length;H<F;H++){var D=B[H];var C=z.nodeChildren(K,D);var E=z.nodeChecked(K,D);if(D.nocheck!==true&&D.chkDisabled!==true&&E==J){G.push(D);if(I){break}}z.getTreeCheckedNodes(K,C,J,G);if(I&&G.length>0){break}}return G},getTreeChangeCheckedNodes:function(H,D,G){if(!D){return[]}G=!G?[]:G;for(var F=0,C=D.length;F<C;F++){var I=D[F];var E=z.nodeChildren(H,I);var B=z.nodeChecked(H,I);if(I.nocheck!==true&&I.chkDisabled!==true&&B!=I.checkedOld){G.push(I)}z.getTreeChangeCheckedNodes(H,E,G)}return G},makeChkFlag:function(I,C){if(!C){return}var F=-1;var B=z.nodeChildren(I,C);if(B){for(var H=0,D=B.length;H<D;H++){var J=B[H];var E=z.nodeChecked(I,J);var G=-1;if(I.check.chkStyle==r.radio.STYLE){if(J.nocheck===true||J.chkDisabled===true){G=J.check_Child_State}else{if(J.halfCheck===true){G=2}else{if(E){G=2}else{G=J.check_Child_State>0?2:0}}}if(G==2){F=2;break}else{if(G==0){F=0}}}else{if(I.check.chkStyle==r.checkbox.STYLE){if(J.nocheck===true||J.chkDisabled===true){G=J.check_Child_State}else{if(J.halfCheck===true){G=1}else{if(E){G=(J.check_Child_State===-1||J.check_Child_State===2)?2:1}else{G=(J.check_Child_State>0)?1:0}}}if(G===1){F=1;break}else{if(G===2&&F>-1&&H>0&&G!==F){F=1;break}else{if(F===2&&G>-1&&G<2){F=1;break}else{if(G>-1){F=G}}}}}}}}C.check_Child_State=F}},h={},m={onCheckNode:function(F,E){if(E.chkDisabled===true){return false}var D=z.getSetting(F.data.treeId);if(u.apply(D.callback.beforeCheck,[D.treeId,E],true)==false){return true}var B=z.nodeChecked(D,E);z.nodeChecked(D,E,!B);k.checkNodeRelation(D,E);var C=j(E,r.id.CHECK,D);k.setChkClass(D,C,E);k.repairParentChkClassWithSelf(D,E);D.treeObj.trigger(r.event.CHECK,[F,D.treeId,E]);return true},onMouseoverCheck:function(E,D){if(D.chkDisabled===true){return false}var C=z.getSetting(E.data.treeId),B=j(D,r.id.CHECK,C);D.check_Focus=true;k.setChkClass(C,B,D);return true},onMouseoutCheck:function(E,D){if(D.chkDisabled===true){return false}var C=z.getSetting(E.data.treeId),B=j(D,r.id.CHECK,C);D.check_Focus=false;k.setChkClass(C,B,D);return true}},i={},e={checkNodeRelation:function(K,D){var I,G,E,B=r.radio;var F=z.nodeChecked(K,D);if(K.check.chkStyle==B.STYLE){var L=z.getRadioCheckedList(K);if(F){if(K.check.radioType==B.TYPE_ALL){for(G=L.length-1;G>=0;G--){I=L[G];var J=z.nodeChecked(K,I);if(J&&I!=D){z.nodeChecked(K,I,false);L.splice(G,1);k.setChkClass(K,j(I,r.id.CHECK,K),I);if(I.parentTId!=D.parentTId){k.repairParentChkClassWithSelf(K,I)}}}L.push(D)}else{var H=(D.parentTId)?D.getParentNode():z.getRoot(K);var C=z.nodeChildren(K,H);for(G=0,E=C.length;G<E;G++){I=C[G];var J=z.nodeChecked(K,I);if(J&&I!=D){z.nodeChecked(K,I,false);k.setChkClass(K,j(I,r.id.CHECK,K),I)}}}}else{if(K.check.radioType==B.TYPE_ALL){for(G=0,E=L.length;G<E;G++){if(D==L[G]){L.splice(G,1);break}}}}}else{var C=z.nodeChildren(K,D);if(F&&(!C||C.length==0||K.check.chkboxType.Y.indexOf("s")>-1)){k.setSonNodeCheckBox(K,D,true)}if(!F&&(!C||C.length==0||K.check.chkboxType.N.indexOf("s")>-1)){k.setSonNodeCheckBox(K,D,false)}if(F&&K.check.chkboxType.Y.indexOf("p")>-1){k.setParentNodeCheckBox(K,D,true)}if(!F&&K.check.chkboxType.N.indexOf("p")>-1){k.setParentNodeCheckBox(K,D,false)}}},makeChkClass:function(C,F){var H=r.checkbox,E=r.radio,G="";var B=z.nodeChecked(C,F);if(F.chkDisabled===true){G=H.DISABLED}else{if(F.halfCheck){G=H.PART}else{if(C.check.chkStyle==E.STYLE){G=(F.check_Child_State<1)?H.FULL:H.PART}else{G=B?((F.check_Child_State===2||F.check_Child_State===-1)?H.FULL:H.PART):((F.check_Child_State<1)?H.FULL:H.PART)}}}var D=C.check.chkStyle+"_"+(B?H.TRUE:H.FALSE)+"_"+G;D=(F.check_Focus&&F.chkDisabled!==true)?D+"_"+H.FOCUS:D;return r.className.BUTTON+" "+H.DEFAULT+" "+D},repairAllChk:function(F,H){if(F.check.enable&&F.check.chkStyle===r.checkbox.STYLE){var C=z.getRoot(F);var E=z.nodeChildren(F,C);for(var D=0,B=E.length;D<B;D++){var G=E[D];if(G.nocheck!==true&&G.chkDisabled!==true){z.nodeChecked(F,G,H)}k.setSonNodeCheckBox(F,G,H)}}},repairChkClass:function(C,D){if(!D){return}z.makeChkFlag(C,D);if(D.nocheck!==true){var B=j(D,r.id.CHECK,C);k.setChkClass(C,B,D)}},repairParentChkClass:function(C,D){if(!D||!D.parentTId){return}var B=D.getParentNode();k.repairChkClass(C,B);k.repairParentChkClass(C,B)},repairParentChkClassWithSelf:function(C,D){if(!D){return}var B=z.nodeChildren(C,D);if(B&&B.length>0){k.repairParentChkClass(C,B[0])}else{k.repairParentChkClass(C,D)}},repairSonChkDisabled:function(H,I,G,D){if(!I){return}if(I.chkDisabled!=G){I.chkDisabled=G}k.repairChkClass(H,I);var F=z.nodeChildren(H,I);if(F&&D){for(var E=0,C=F.length;E<C;E++){var B=F[E];k.repairSonChkDisabled(H,B,G,D)}}},repairParentChkDisabled:function(D,E,C,B){if(!E){return}if(E.chkDisabled!=C&&B){E.chkDisabled=C}k.repairChkClass(D,E);k.repairParentChkDisabled(D,E.getParentNode(),C,B)},setChkClass:function(B,D,C){if(!D){return}if(C.nocheck===true){D.hide()}else{D.show()}D.attr("class",k.makeChkClass(B,C))},setParentNodeCheckBox:function(L,C,J,G){var H=j(C,r.id.CHECK,L);if(!G){G=C}z.makeChkFlag(L,C);if(C.nocheck!==true&&C.chkDisabled!==true){z.nodeChecked(L,C,J);k.setChkClass(L,H,C);if(L.check.autoCheckTrigger&&C!=G){L.treeObj.trigger(r.event.CHECK,[null,L.treeId,C])}}if(C.parentTId){var I=true;if(!J){var B=z.nodeChildren(L,C.getParentNode());for(var F=0,E=B.length;F<E;F++){var K=B[F];var D=z.nodeChecked(L,K);if((K.nocheck!==true&&K.chkDisabled!==true&&D)||((K.nocheck===true||K.chkDisabled===true)&&K.check_Child_State>0)){I=false;break}}}if(I){k.setParentNodeCheckBox(L,C.getParentNode(),J,G)}}},setSonNodeCheckBox:function(K,D,J,G){if(!D){return}var H=j(D,r.id.CHECK,K);if(!G){G=D}var B=false;var C=z.nodeChildren(K,D);if(C){for(var F=0,E=C.length;F<E;F++){var I=C[F];k.setSonNodeCheckBox(K,I,J,G);if(I.chkDisabled===true){B=true}}}if(D!=z.getRoot(K)&&D.chkDisabled!==true){if(B&&D.nocheck!==true){z.makeChkFlag(K,D)}if(D.nocheck!==true&&D.chkDisabled!==true){z.nodeChecked(K,D,J);if(!B){D.check_Child_State=(C&&C.length>0)?(J?2:0):-1}}else{D.check_Child_State=-1}k.setChkClass(K,H,D);if(K.check.autoCheckTrigger&&D!=G&&D.nocheck!==true&&D.chkDisabled!==true){K.treeObj.trigger(r.event.CHECK,[null,K.treeId,D])}}}},t={tools:i,view:e,event:h,data:q};f.extend(true,f.fn.zTree.consts,A);f.extend(true,f.fn.zTree._z,t);var c=f.fn.zTree,u=c._z.tools,r=c.consts,k=c._z.view,z=c._z.data,s=c._z.event,j=u.$;z.nodeChecked=function(D,E,B){if(!E){return false}var C=D.data.key.checked;if(typeof B!=="undefined"){if(typeof B==="string"){B=u.eqs(checked,"true")}B=!!B;E[C]=B}return E[C]};z.exSetting(n);z.addInitBind(o);z.addInitUnBind(y);z.addInitCache(d);z.addInitNode(v);z.addInitProxy(p,true);z.addInitRoot(w);z.addBeforeA(a);z.addZTreeTools(l);var x=k.createNodes;k.createNodes=function(E,F,C,B,D){if(x){x.apply(k,arguments)}if(!C){return}k.repairParentChkClassWithSelf(E,B)};var b=k.removeNode;k.removeNode=function(C,D){var B=D.getParentNode();if(b){b.apply(k,arguments)}if(!D||!B){return}k.repairChkClass(C,B);k.repairParentChkClass(C,B)};var g=k.appendNodes;k.appendNodes=function(G,I,C,B,D,F,H){var E="";if(g){E=g.apply(k,arguments)}if(B){z.makeChkFlag(G,B)}return E}})(jQuery);